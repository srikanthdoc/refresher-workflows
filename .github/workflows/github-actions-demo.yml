name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€
on: 
  push:
    paths:
      - 'Docker*'
jobs:
  find-and-run:
    runs-on: ubuntu-latest
    outputs:
      docker_files: ${{ steps.find_files.outputs.docker_files }}
    steps:
      - name: Check out code
        uses: actions/checkout@v2

      - name: Find Docker files
        id: find_files
        run: |
          # Find all files with 'Docker' in their name
          files=$(find . -name "*Docker*")
          # Convert newline-separated files to a JSON array
          if [ -z "$files" ]; then
            files_json="[]"
          else
            # Convert newline-separated files to a JSON array
            files_json=$(echo "$files" | jq -R -s 'split("\n") | map(select(. != "")) | .[] |= ltrimstr(" ") | .[] |= rtrimstr(" ") | .')
          fi
          
          echo files_json
          echo "docker_files=$files_json" >> $GITHUB_ENV    
              

  build_push:
    runs-on: ubuntu-latest    
    needs: find-and-run
    strategy:
      matrix:
        dockerfile: ${{ fromJson(needs.find-and-run.outputs.docker_files) }}  # Uses dynamic Dockerfiles found
    steps:
      - name: Build with Dockerfile
        run: |
          echo "Processing Dockerfile: ${{ matrix.dockerfile }}"
          # Add Docker build steps here



    
